<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ALPACA Chat</title>
  <style>
    /* ... (your styles unchanged) ... */
  </style>
</head>
<body>
  <h1>ü•Ä√ù√ù√ù ü¶ô</h1>
  <div class="chatbox">
    <div id="messages"></div>
    <form id="chatForm" autocomplete="off">
      <input type="text" id="userInput" placeholder="Talk to ALPACA..." required />
      <button type="submit">Send</button>
    </form>
  </div>
<script>
  const form = document.getElementById("chatForm");
  const messagesDiv = document.getElementById("messages");
  const userInput = document.getElementById("userInput");

  function appendMessage(sender, text) {
    const msg = document.createElement("div");
    msg.innerHTML = `<strong>${sender}:</strong> ${text}`;
    messagesDiv.appendChild(msg);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const userMsg = userInput.value.trim();
    if (!userMsg) return;

    appendMessage("YOU", userMsg);
    userInput.value = "";

    try {
      const apiUrl = "https://a-l-p-a-c-a.vercel.app/api/alpacachat"; // <--- FIXED
      const res = await fetch(apiUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          messages: [{ role: "user", content: userMsg }]
        }),
      });

      let data;
      try {
        data = await res.json();
      } catch (e) {
        const text = await res.text();
        appendMessage("ERROR", "API did not return JSON: " + text.slice(0, 100));
        return;
      }

      console.log("Frontend got:", data); // üëà for debugging
      appendMessage("ALPACA", data.reply || "(no response)");
    } catch (err) {
      appendMessage("ERROR", "API call failed: " + err.message);
    }
  });
</script>
</body>
</html>
